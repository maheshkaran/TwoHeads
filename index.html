<!-- Create the layout for the video chat -->
<div id="video-chat">
    <div id="local-video-container">
      <video id="localVideo" autoplay></video>
    </div>
    <div id="remote-video-container">
      <video id="remoteVideo" autoplay></video>
    </div>
  </div>
  
  <!-- Create a button to start the call -->
  <button id="start-call-button">Start Call</button>
  
  <!-- Create a container for the whiteboard -->
  <div id="whiteboard-container">
    <canvas id="whiteboard" width="600" height="400"></canvas>
  </div>
  
  <!-- Style the layout with CSS -->
  <style>
    #video-chat {
      display: flex;
      align-items: center;
      justify-content: center;
    }
  
    #local-video-container, #remote-video-container {
      width: 50%;
      height: 100%;
      position: relative;
    }
  
    #localVideo {
      position: absolute;
      bottom: 10px;
      right: 10px;
      width: 150px;
      height: auto;
      border: 2px solid white;
      border-radius: 5px;
      background: black;
    }
  
    #remoteVideo {
      width: 100%;
      height: 100%;
    }
  
    #start-call-button {
      position: absolute;
      top: 10px;
      left: 10px;
    }
  
    #whiteboard-container {
      display: none;
    }
  </style>
  
  <!-- Add JavaScript to handle user interactions -->
  <script>
    const startCallButton = document.getElementById('start-call-button');
    startCallButton.addEventListener('click', startCall);
  
    function startCall() {
  // Get a reference to the video elements
  const localVideo = document.getElementById('localVideo');
  const remoteVideo = document.getElementById('remoteVideo');

  // Set up the peer connection and start the call
  const peerConnection = new RTCPeerConnection();
  navigator.mediaDevices.getUserMedia({ video: true, audio: true })
    .then(stream => {
      localVideo.srcObject = stream;
      stream.getTracks().forEach(track => peerConnection.addTrack(track, stream));
    })
    .then(() => peerConnection.createOffer())
    .then(offer => peerConnection.setLocalDescription(offer))
    .then(() => {
      // Send the offer to the other peer using your signaling server
      sendToServer({
        type: 'offer',
        sdp: peerConnection.localDescription
      });
    });

  // Set up event listeners to handle incoming calls
  peerConnection.ontrack = event => {
    remoteVideo.srcObject = event.streams[0];
  };
  peerConnection.onicecandidate = event => {
    if (event.candidate) {
      sendToServer({
        type: 'candidate',
        candidate: event.candidate
      });
    }
  };

  // Hide the start call button and show the whiteboard
  document.getElementById('start-call-button').style.display = 'none';
  document.getElementById('whiteboard-container').style.display = 'block';
}

  </script>

  <!-- Create the whiteboard canvas -->
<canvas id="whiteboard" width="600" height="400"></canvas>

<!-- Set up the canvas context and drawing tools -->
<script>
  const canvas = document.getElementById('whiteboard');
  const context = canvas.getContext('2d');
  let isDrawing = false;

  canvas.addEventListener('mousedown', () => isDrawing = true);
  canvas.addEventListener('mouseup', () => isDrawing = false);
  canvas.addEventListener('mouseout', () => isDrawing = false);
  canvas.addEventListener('mousemove', draw);

  function draw(event) {
    if (!isDrawing) return;

    context.lineWidth = 2;
    context.lineCap = 'round';
    context.strokeStyle = 'black';

    context.beginPath();
    context.moveTo(event.offsetX, event.offsetY);
    context.lineTo(event.offsetX + 1, event.offsetY + 1);
    context.stroke();
    context.closePath();

    // Send the drawing data to the other peer using the signaling server
    sendToServer({
      type: 'drawing',
      data: {
        x: event.offsetX,
        y: event.offsetY
      }
    });
  }
</script>
  